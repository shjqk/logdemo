<?xml version="1.0" encoding="utf-8" ?>
<configuration status="error">


    <Appenders>
        <Property name="log.basedir">log</Property>

        <Routing name="Routing">
            <Routes pattern="$${ctx:ROUTINGKEY}">
                <!-- This route is chosen if ThreadContext has value 'special' for key ROUTINGKEY. -->
                <Route key="special">
                    <RollingFile name="Rolling-${ctx:ROUTINGKEY}" fileName="logs/special-${ctx:ROUTINGKEY}.log"
                                 filePattern="./logs/${date:yyyy-MM}/${ctx:ROUTINGKEY}-special-%d{yyyy-MM-dd}-%i.log.gz">
                        <PatternLayout>
                            <Pattern>%d{ISO8601} [%t] %p %c{3} - %m%n</Pattern>
                        </PatternLayout>
                        <Policies>
                            <TimeBasedTriggeringPolicy interval="6" modulate="true"/>
                            <SizeBasedTriggeringPolicy size="10 MB"/>
                        </Policies>
                    </RollingFile>
                </Route>
                <!-- This route is chosen if ThreadContext has no value for key ROUTINGKEY. -->
                <Route key="$${ctx:ROUTINGKEY}">
                    <RollingFile name="Rolling-default" fileName="logs/default.log"
                                 filePattern="./logs/${date:yyyy-MM}/default-%d{yyyy-MM-dd}-%i.log.gz">
                        <PatternLayout>
                            <pattern>%d{ISO8601} [%t] %p %c{3} - %m%n</pattern>
                        </PatternLayout>
                        <Policies>
                            <TimeBasedTriggeringPolicy interval="6" modulate="true"/>
                            <SizeBasedTriggeringPolicy size="10 MB"/>
                        </Policies>
                    </RollingFile>
                </Route>
                <!-- This route is chosen if ThreadContext has a value for ROUTINGKEY
                     (other than the value 'special' which had its own route above).
                     The value dynamically determines the name of the log file. -->
                <Route>
                    <RollingFile name="Rolling-${ctx:ROUTINGKEY}" fileName="logs/other-${ctx:ROUTINGKEY}.log"
                                 filePattern="./logs/${date:yyyy-MM}/${ctx:ROUTINGKEY}-other-%d{yyyy-MM-dd}-%i.log.gz" append = "false">
                        <PatternLayout>
                            <pattern>%d{ISO8601} [%t] %p %c{3} - %m%n</pattern>
                        </PatternLayout>
                        <Policies>
                            <TimeBasedTriggeringPolicy interval="6" modulate="true"/>
                            <SizeBasedTriggeringPolicy size="10 MB"/>
                        </Policies>
                    </RollingFile>
                </Route>
            </Routes>
        </Routing>


        <Console name="console">
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%-5level] [%class{36}] %L %M - %msg%xEx%n" />
        </Console>
        <TestAppender name="testappender">
            <PatternLayout pattern=" pattenrn - %msg%xEx%n" />
        </TestAppender>
        <File name="error_appender" fileName="log/exception.log" append="false">
            <!-- 过滤器 -->
            <Filters>
                <!-- 限制日志级别在error及以上 -->
                <ThresholdFilter level="error"/>
            </Filters>
            <PatternLayout pattern="%d{HH:mm:ss.SSS} %-5level %class{36} %L %M - %msg%xEx%n"/>
        </File>
        <!-- 一分钟一个日志 -->
        <RollingFile name="file_appender" fileName="log/RollingFile.log" filePattern="log/app-%d{yyyy-MM-dd_HH_mm}.log.gz"
                     ignoreExceptions="false">
            <PatternLayout>
                <Pattern>%d{HH:mm:ss.SSS} [%-5level] [%class{36}] %L %M - %msg%xEx%n</Pattern>
            </PatternLayout>
            <TimeBasedTriggeringPolicy />
        </RollingFile>
    </Appenders>
    <Loggers>

        <Logger name="com.ctrip.flight.exchange" level="error" additivity="true">
            <AppenderRef ref="error_appender"/>
            <!-- <AppenderRef ref="console"/> -->
        </Logger>
        <Logger name="com.ctrip.flight.exchange" level="info" additivity="true">
            <AppenderRef ref="file_appender"/>
            <!-- <AppenderRef ref="testappender"/> -->
        </Logger>
        <Logger name="com.ctrip.flight.exchange" level="info" additivity="true">
            <AppenderRef ref="console"/>
            <!-- <AppenderRef ref="console"/> -->
        </Logger>


        <AsyncLogger name="async" level="info" additivity="false">
            <AppenderRef ref="testappender"/>
        </AsyncLogger>
        <Root level="info">
            <AppenderRef ref="console" />
            <!-- <AppenderRef ref="testappender"/> -->
        </Root>
    </Loggers>

</configuration>